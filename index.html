<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Photo Gallery</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  h1 { text-align: center; }
  #gallery { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; }
  .photo { border: 1px solid #ccc; padding: 5px; width: 180px; text-align: center; cursor: pointer; transition: transform 0.2s; }
  .photo:hover { transform: scale(1.05); }
  .photo img { width: 100%; height: auto; display: block; }
  .caption { font-size: 0.85em; margin-top: 5px; color: #333; }

  /* Fullscreen modal */
  #modal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); overflow: auto; }
  #modal img { display: block; max-width: 90%; max-height: 80%; margin: 50px auto 10px auto; }
  #modal .info { text-align: center; color: #fff; font-size: 1.1em; }
  #modal .close { position: absolute; top: 20px; right: 40px; font-size: 40px; font-weight: bold; color: #fff; cursor: pointer; }
</style>
</head>
<body>

<h1>Photo Gallery</h1>
<div id="gallery"></div>

<!-- Fullscreen modal -->
<div id="modal">
  <span class="close">&times;</span>
  <img id="modal-img" src="" alt="">
  <div class="info" id="modal-info"></div>
</div>

<script>
fetch('gallery.json')
  .then(res => res.json())
  .then(data => {
    const container = document.getElementById('gallery');

    data.forEach(folder => {
      // Folder title
      const folderTitle = document.createElement('h2');
      folderTitle.textContent = folder.folder;
      folderTitle.style.width = '100%';
      folderTitle.style.textAlign = 'center';
      container.appendChild(folderTitle);

      folder.photos.forEach(p => {
        const div = document.createElement('div');
        div.className = 'photo';

        // Thumbnail (w200)
        const img = document.createElement('img');
        img.src = `https://drive.google.com/thumbnail?id=${p.id}&sz=w200`;
        div.appendChild(img);

        // Caption (basic info)
        const caption = document.createElement('div');
        caption.className = 'caption';
        caption.textContent = `${p.metadata.aircraft || ""} ${p.metadata.registration || ""}`;
        div.appendChild(caption);

        // Click to open modal (full-size thumbnail w1920)
        div.addEventListener('click', () => {
          document.getElementById('modal-img').src = `https://drive.google.com/thumbnail?id=${p.id}&sz=w1920`;
          const md = p.metadata || {};
          document.getElementById('modal-info').textContent =
            `Date: ${md.date || ""} | Airport: ${md.airport || ""} | Registration: ${md.registration || ""} | Aircraft: ${md.aircraft || ""}`;
          document.getElementById('modal').style.display = 'block';
        });

        container.appendChild(div);
      });
    });
  })
  .catch(err => console.error("Failed to load gallery.json:", err));

// Close modal
document.querySelector('#modal .close').onclick = () => {
  document.getElementById('modal').style.display = 'none';
};
</script>

</body>
</html>
